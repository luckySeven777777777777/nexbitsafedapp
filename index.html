<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connect Wallet</title>

  <style>
    #connectButton {
      padding: 12px 24px;
      background-color: #f6851b;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    #walletStatus {
      margin-top: 12px;
      font-size: 14px;
    }
    #walletSelector {
      display: none;
      margin-top: 10px;
    }
    .wallet-option {
      display: flex;
      align-items: center;
      padding: 10px;
      background-color: #f0f0f0;
      margin-bottom: 10px;
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.3s;
    }
    .wallet-option:hover {
      background-color: #e6e6e6;
    }
    .wallet-option img {
      margin-right: 12px;
      width: 30px;
      height: 30px;
    }
  </style>
</head>

<body>

  <button id="connectButton">Connect Wallet</button>

  <div id="walletSelector">
    <div class="wallet-option" id="metamaskOption">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT3ymr3UNKopfI0NmUY95Dr-0589vG-91KuAA&s" />
      MetaMask
    </div>

    <div class="wallet-option" id="walletconnectOption">
      <img src="https://99bitcoins.com/wp-content/uploads/2025/03/crypto.com-wallet-logo.jpg" />
      Crypto.com DeFi Wallet
    </div>

    <div class="wallet-option" id="trustWalletOption">
      <img src="https://logowik.com/content/uploads/images/trust-wallet-shield4830.logowik.com.webp" />
      Trust Wallet
    </div>

    <div class="wallet-option" id="okxWalletOption">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR8aoojZr1ORW_wq3W0bxM4aQEY9kIotJEcKg&s" />
      OKX Wallet
    </div>

    <div class="wallet-option" id="safepalWalletOption">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR36IDA58MpqEx-G_pB8f6zmVVoAjI3pkzldA&s" />
      SafePal Wallet
    </div>
  </div>

  <div id="walletStatus">Not connected</div>

  <!-- WalletConnect v2 官方 UMD -->
  <script src="https://unpkg.com/@walletconnect/ethereum-provider@2.11.0/dist/index.umd.js"></script>

  <script>
    const btn = document.getElementById("connectButton");
    const info = document.getElementById("walletStatus");
    const walletSelector = document.getElementById("walletSelector");

    let wcProvider = null;
    let wcReady = false;

    // 显示钱包列表
    btn.onclick = () => {
      walletSelector.style.display = "block";
    };

    // MetaMask 连接
    const connectMetaMask = async () => {
      try {
        if (!window.ethereum) {
          info.innerText = "❌ MetaMask not installed";
          return;
        }
        const accounts = await window.ethereum.request({
          method: "eth_requestAccounts"
        });
        info.innerText = "✅ Connected: " + accounts[0];
      } catch (e) {
        info.innerText = "❌ MetaMask connection rejected";
      }
    };

    document.getElementById("metamaskOption").onclick = connectMetaMask;

    // WalletConnect 初始化（页面加载即执行）
    (async () => {
      try {
        wcProvider = await window.WalletConnectEthereumProvider.init({
          projectId: "257aebada0de0efef7d425e84b57ebfe",
          chains: [1],
          showQrModal: true,
          metadata: {
            name: "NEXBIT",
            description: "NEXBIT DApp",
            url: window.location.origin,
            icons: []
          }
        });
        wcReady = true;
      } catch (e) {
        console.error(e);
        info.innerText = "❌ WalletConnect init failed";
      }
    })();

    // WalletConnect 连接（统一入口）
    const connectWalletConnect = async () => {
      try {
        if (!wcReady || !wcProvider) {
          info.innerText = "⏳ WalletConnect initializing...";
          return;
        }

        await wcProvider.connect();

        const accounts = await wcProvider.request({
          method: "eth_accounts"
        });

        info.innerText = "✅ Connected: " + accounts[0];
      } catch (e) {
        console.error(e);
        info.innerText = "❌ WalletConnect failed";
      }
    };

    // 所有 WalletConnect 钱包统一走官方 Modal
    document.getElementById("walletconnectOption").onclick =
    document.getElementById("trustWalletOption").onclick =
    document.getElementById("okxWalletOption").onclick =
    document.getElementById("safepalWalletOption").onclick = connectWalletConnect;
  </script>

</body>
</html>
